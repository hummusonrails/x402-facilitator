# Network Configuration
# Options: arbitrum, arbitrum-sepolia
NETWORK=arbitrum-sepolia

# RPC URLs
ARBITRUM_RPC_URL=https://arb1.arbitrum.io/rpc
ARBITRUM_SEPOLIA_RPC_URL=https://sepolia-rollup.arbitrum.io/rpc

# Database Configuration (REQUIRED for production)
# PostgreSQL credentials
POSTGRES_USER=facilitator
POSTGRES_PASSWORD=change_me_in_production
POSTGRES_DB=facilitator
POSTGRES_HOST=localhost
POSTGRES_PORT=5432

# Full connection string
# Format: postgresql://user:password@host:port/database
# IMPORTANT: Use actual values, not ${VARIABLE} syntax (Node.js doesn't expand them)
# Example: DATABASE_URL=postgresql://facilitator:password123@localhost:5432/facilitator
DATABASE_URL=postgresql://facilitator:facilitator@localhost:5432/facilitator

# SSL configuration
PGSSL=false

# Facilitator Private Key (required)
# This is YOUR private key - you pay gas fees and receive service fees
# Payments flow: User → Facilitator → Merchant (you keep the fee)
FACILITATOR_PRIVATE_KEY=0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef
# or use EVM_PRIVATE_KEY=0x1234567890abcdef1234567890abcdef1234567890abcdef1234567890abcdef

# ============================================================================
# AUTHENTICATION CONFIGURATION
# ============================================================================

# Admin API Key Hash (for /admin/refund endpoint)
# This is used by the admin dashboard to execute refunds
# 
# Setup (ONE TIME):
# 1. Generate admin key: pnpm generate-api-key
# 2. Copy the HASH (not the plain key) here with $$ escaping
# 3. Give the PLAIN KEY to your admin dashboard (.env: FACILITATOR_ADMIN_KEY)
#
# IMPORTANT: Escape $ symbols with $$ for Docker Compose compatibility
# Example: ADMIN_API_KEY_HASH=$$2b$$10$$abcdefghijklmnopqrstuvwxyz...
#
ADMIN_API_KEY_HASH=

# Merchant API Keys (for /settle endpoint)
# Merchants are stored in the DATABASE, not in this .env file
# Each merchant gets their own API key stored in the merchants table
#
# To add a merchant:
# 1. Generate API key: pnpm generate-api-key
# 2. Add to database: pnpm merchants add 0xAddress "Name" "$2b$10$hash..."
# 3. Give the PLAIN KEY to the merchant (they use it in X-API-Key header)
#
# See docs/MERCHANT_MANAGEMENT.md for details

# Fee Configuration
# Service fee in basis points (100 = 1%, 50 = 0.5%, 10 = 0.1%)
SERVICE_FEE_BPS=50

# Gas fee to charge per transaction in USDC (6 decimals)
# Default: 100000 = 0.1 USDC (covers gas on Arbitrum)
GAS_FEE_USDC=100000

# USDC Address (optional, defaults provided)
# Arbitrum Mainnet: 0xaf88d065e77c8cC2239327C5EDb3A432268e5831 (native USDC)
# Arbitrum Sepolia: 0x75faf114eafb1BDbe2F0316DF893fd58CE46AA4d (test USDC)
USDC_ADDRESS=

# Server Configuration
# Optional: Server port (default: 3002)
PORT=3002

# Settlement Limits
# Optional: Max settlement amount in smallest unit (default: 1000 USDC)
MAX_SETTLEMENT_AMOUNT=1000000000

# Optional: Recovery worker interval in milliseconds (default: 300000 = 5 minutes)
# How often to check for and retry incomplete settlements
RECOVERY_INTERVAL_MS=300000

# SDK Compatibility
# Alternative environment variable name for private key (EVM_PRIVATE_KEY or FACILITATOR_PRIVATE_KEY)
# EVM_PRIVATE_KEY=0x...

# Optional: Allow legacy clients to specify recipient (default: false)
# When false, server enforces facilitator address as recipient regardless of client input
ALLOW_CLIENT_RECIPIENT=false
